<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Stotram Transliterator + Formatter (Bidirectional)</title>
  <style>
    body {
      font-family: 'Noto Serif', serif;
      background: #f9f9f9;
      color: #333;
      padding: 2em;
      max-width: 800px;
      margin: auto;
    }

    textarea {
      width: 100%;
      height: 150px;
      font-size: 1.1em;
      padding: 10px;
      font-family: 'Noto Serif Devanagari', serif;
    }

    .options-bar {
      margin-top: 10px;
      margin-bottom: 10px;
      display: flex;
      gap: 10px;
      background: #e6e6e6;
      padding: 10px;
      border-radius: 6px;
      justify-content: center;
    }

    .options-bar label {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    button {
      margin-top: 10px;
      padding: 10px 20px;
      font-size: 1em;
      background: #4caf50;
      color: white;
      border: none;
      cursor: pointer;
    }

    .shloka {
      margin-top: 2em;
      margin-bottom: 1.5em;
    }

    .devanagari, .bengali {
      font-size: 1.3em;
      font-weight: bold;
      color: #222;
      white-space: pre-wrap;
    }

    .iast {
      font-size: 1.1em;
      font-style: italic;
      color: #555;
      white-space: pre-wrap;
    }

    h2 {
      margin-top: 2em;
    }
  </style>
</head>
<body>

  <h1>Stotram/Path Transliterator + Formatter</h1>

  <h2>Input</h2>
  <div class="options-bar" id="inputModeBar">
    <label><input type="radio" name="inputMode" value="devanagari" checked> Devanagari</label>
    <label><input type="radio" name="inputMode" value="bengali"> Bengali</label>
    <label><input type="radio" name="inputMode" value="iast"> IAST</label>
  </div>

  <textarea id="textInput" placeholder="Enter text here"></textarea>

  <h2>Output</h2>
  <div class="options-bar" id="outputModeBar">
    <label><input type="radio" name="outputMode" value="both" checked> Both</label>
    <label><input type="radio" name="outputMode" value="devanagari"> Devanagari</label>
    <label><input type="radio" name="outputMode" value="bengali"> Bengali</label>
    <label><input type="radio" name="outputMode" value="iast"> IAST</label>
  </div>

  <button onclick="processInput()">Transliterate</button>

  <div id="output"></div>

  <script>
    // Devanagari → IAST
    const devToIAST = {
      'क':'k','ख':'kh','ग':'g','घ':'gh','ङ':'ṅ',
      'च':'c','छ':'ch','ज':'j','झ':'jh','ञ':'ñ',
      'ट':'ṭ','ठ':'ṭh','ड':'ḍ','ढ':'ḍh','ण':'ṇ',
      'त':'t','थ':'th','द':'d','ध':'dh','न':'n',
      'प':'p','फ':'ph','ब':'b','भ':'bh','म':'m',
      'य':'y','र':'r','ल':'l','व':'v',
      'श':'ś','ष':'ṣ','स':'s','ह':'h',
      'अ':'a','आ':'ā','इ':'i','ई':'ī','उ':'u','ऊ':'ū',
      'ऋ':'ṛ','ॠ':'ṝ','ए':'e','ऐ':'ai','ओ':'o','औ':'au',
      'ा':'ā','ि':'i','ी':'ī','ु':'u','ू':'ū','ृ':'ṛ','ॄ':'ṝ',
      'े':'e','ै':'ai','ो':'o','ौ':'au',
      'ं':'ṃ','ः':'ḥ','ँ':'̃','्':'','ऽ':"'",'।':'|','॥':'||',
      '०':'0','१':'1','२':'2','३':'3','४':'4','५':'5','६':'6','७':'7','८':'8','९':'9'
    };

    // Bengali → IAST
    const benToIAST = {
      'ক':'k','খ':'kh','গ':'g','ঘ':'gh','ঙ':'ṅ',
      'চ':'c','ছ':'ch','জ':'j','ঝ':'jh','ঞ':'ñ',
      'ট':'ṭ','ঠ':'ṭh','ড':'ḍ','ঢ':'ḍh','ণ':'ṇ',
      'ত':'t','থ':'th','দ':'d','ধ':'dh','ন':'n',
      'প':'p','ফ':'ph','ব':'b','ভ':'bh','ম':'m',
      'য':'y','র':'r','ল':'l','শ':'ś','ষ':'ṣ','স':'s','হ':'h',
      'অ':'a','আ':'ā','ই':'i','ঈ':'ī','উ':'u','ঊ':'ū',
      'ঋ':'ṛ','ৠ':'ṝ','এ':'e','ঐ':'ai','ও':'o','ঔ':'au',
      'া':'ā','ি':'i','ী':'ī','ু':'u','ূ':'ū','ৃ':'ṛ',
      'ে':'e','ৈ':'ai','ো':'o','ৌ':'au',
      'ং':'ṃ','ঃ':'ḥ','ঁ':'̃','্':'','।':'|','॥':'||',
      '০':'0','১':'1','২':'2','৩':'3','৪':'4','৫':'5','৬':'6','৭':'7','৮':'8','৯':'9'
    };

    // IAST → Devanagari (basic reverse)
    const iastToDev = [
      ['ā','आ'],['ī','ई'],['ū','ऊ'],['ṛ','ऋ'],['ṝ','ॠ'],
      ['ṅ','ङ'],['ñ','ञ'],['ṭh','ठ'],['ṭ','ट'],['ḍh','ढ'],['ḍ','ड'],['ṇ','ण'],
      ['ś','श'],['ṣ','ष'],['ḥ','ः'],['ṃ','ं'],["'",'ऽ'],
      ['ai','ऐ'],['au','औ'],
      ['a','अ'],['i','इ'],['u','उ'],['e','ए'],['o','ओ'],
      ['kh','ख'],['gh','घ'],['ch','छ'],['jh','झ'],['th','थ'],['dh','ध'],['ph','फ'],['bh','भ'],
      ['k','क'],['g','ग'],['c','च'],['j','ज'],['t','त'],['d','द'],['n','न'],['p','प'],['b','ब'],
      ['m','म'],['y','य'],['r','र'],['l','ल'],['v','व'],['s','स'],['h','ह']
    ];

    // IAST → Bengali (basic reverse)
    const iastToBen = [
      ['ā','আ'],['ī','ঈ'],['ū','ঊ'],['ṛ','ঋ'],['ṝ','ৠ'],
      ['ṅ','ঙ'],['ñ','ঞ'],['ṭh','ঠ'],['ṭ','ট'],['ḍh','ঢ'],['ḍ','ড'],['ṇ','ণ'],
      ['ś','শ'],['ṣ','ষ'],['ḥ','ঃ'],['ṃ','ং'],["'",''],
      ['ai','ঐ'],['au','ঔ'],
      ['a','অ'],['i','ই'],['u','উ'],['e','এ'],['o','ও'],
      ['kh','খ'],['gh','ঘ'],['ch','ছ'],['jh','ঝ'],['th','থ'],['dh','ধ'],['ph','ফ'],['bh','ভ'],
      ['k','ক'],['g','গ'],['c','চ'],['j','জ'],['t','ত'],['d','দ'],['n','ন'],['p','প'],['b','ব'],
      ['m','ম'],['y','য'],['r','র'],['l','ল'],['v','ব'],['s','স'],['h','হ']
    ];

    function toIAST(text, from) {
      if (from === 'devanagari') return text.split('').map(c => devToIAST[c] || c).join('');
      if (from === 'bengali') return text.split('').map(c => benToIAST[c] || c).join('');
      return text;
    }

    function fromIAST(text, to) {
      let out = text;
      const map = to === 'devanagari' ? iastToDev : iastToBen;
      for (const [iast, char] of map) {
        const re = new RegExp(iast, 'g');
        out = out.replace(re, char);
      }
      return out;
    }

    function processInput() {
      const inputMode = document.querySelector('input[name="inputMode"]:checked').value;
      const outputMode = document.querySelector('input[name="outputMode"]:checked').value;
      const inputText = document.getElementById("textInput").value.trim();
      if (!inputText) return;

      const outputDiv = document.getElementById("output");
      outputDiv.innerHTML = '';

      // Break into clusters by double line breaks
      const clusters = inputText.split(/\n\s*\n/).map(c => c.trim()).filter(c => c);

      clusters.forEach(cluster => {
        const shlokaEl = document.createElement("div");
        shlokaEl.className = "shloka";

        let iast = inputMode === 'iast' ? cluster : toIAST(cluster, inputMode);
        let dev = inputMode === 'devanagari' ? cluster : (inputMode === 'iast' ? fromIAST(iast, 'devanagari') : '');
        let ben = inputMode === 'bengali' ? cluster : (inputMode === 'iast' ? fromIAST(iast, 'bengali') : '');

        if (outputMode === 'iast' || outputMode === 'both') {
          const iastEl = document.createElement("div");
          iastEl.className = "iast";
          iastEl.textContent = iast;
          shlokaEl.appendChild(iastEl);
        }
        if (outputMode === 'devanagari' || outputMode === 'both') {
          if (dev) {
            const devEl = document.createElement("div");
            devEl.className = "devanagari";
            devEl.textContent = dev;
            shlokaEl.insertBefore(devEl, shlokaEl.firstChild);
          }
        }
        if (outputMode === 'bengali' || outputMode === 'both') {
          if (ben) {
            const benEl = document.createElement("div");
            benEl.className = "bengali";
            benEl.textContent = ben;
            shlokaEl.insertBefore(benEl, shlokaEl.firstChild);
          }
        }

        outputDiv.appendChild(shlokaEl);
      });
    }
  </script>

</body>
</html>
