<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Stotram/Path Transliterator + Formatter</title>
  <style>
    body {
      font-family: 'Noto Serif', serif;
      background: #f9f9f9;
      color: #333;
      padding: 2em;
      max-width: 900px;
      margin: auto;
    }

    textarea {
      width: 100%;
      height: 140px;
      font-size: 1.1em;
      padding: 10px;
      margin-bottom: 10px;
      font-family: 'Noto Serif Devanagari', 'Noto Serif Bengali', serif;
    }

    .options-bar {
      display: flex;
      justify-content: space-between;
      margin-bottom: 1em;
    }

    select {
      padding: 6px;
      font-size: 1em;
    }

    button {
      padding: 8px 16px;
      font-size: 1em;
      background: #4caf50;
      color: white;
      border: none;
      cursor: pointer;
    }

    .shloka {
      margin-top: 2em;
      margin-bottom: 1.5em;
    }

    .devanagari {
      font-size: 1.3em;
      font-weight: bold;
      color: #222;
      font-family: 'Noto Serif Devanagari', serif;
      white-space: pre-wrap;
    }

    .bengali {
      font-size: 1.3em;
      font-weight: bold;
      color: #222;
      font-family: 'Noto Serif Bengali', serif;
      white-space: pre-wrap;
    }

    .iast {
      font-size: 1.1em;
      font-style: italic;
      color: #555;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>

  <h1>üìú Stotram/Path Transliterator + Formatter</h1>
  <p>Paste or type text below, select input and output scripts, then click <b>Transliterate</b>.</p>

  <textarea id="inputBox" placeholder="Enter text here..."></textarea>

  <div class="options-bar">
    <div>
      Input: 
      <select id="inputScript">
        <option value="devanagari">Devanagari</option>
        <option value="bengali">Bengali</option>
        <option value="iast">IAST</option>
      </select>
    </div>
    <div>
      Output: 
      <select id="outputScript">
        <option value="iast">IAST</option>
        <option value="devanagari">Devanagari</option>
        <option value="bengali">Bengali</option>
        <option value="both">Both (Original + IAST)</option>
      </select>
    </div>
    <button onclick="processInput()">Transliterate</button>
  </div>

  <div id="output"></div>

<script>
  // --- Mappings ---
  const devToIAST = {
    '‡§ï':'k','‡§ñ':'kh','‡§ó':'g','‡§ò':'gh','‡§ô':'·πÖ',
    '‡§ö':'c','‡§õ':'ch','‡§ú':'j','‡§ù':'jh','‡§û':'√±',
    '‡§ü':'·π≠','‡§†':'·π≠h','‡§°':'·∏ç','‡§¢':'·∏çh','‡§£':'·πá',
    '‡§§':'t','‡§•':'th','‡§¶':'d','‡§ß':'dh','‡§®':'n',
    '‡§™':'p','‡§´':'ph','‡§¨':'b','‡§≠':'bh','‡§Æ':'m',
    '‡§Ø':'y','‡§∞':'r','‡§≤':'l','‡§µ':'v',
    '‡§∂':'≈õ','‡§∑':'·π£','‡§∏':'s','‡§π':'h',
    '‡§Ö':'a','‡§Ü':'ƒÅ','‡§á':'i','‡§à':'ƒ´','‡§â':'u','‡§ä':'≈´',
    '‡§ã':'·πõ','‡•†':'·πù','‡§è':'e','‡§ê':'ai','‡§ì':'o','‡§î':'au',
    '‡§æ':'ƒÅ','‡§ø':'i','‡•Ä':'ƒ´','‡•Å':'u','‡•Ç':'≈´','‡•É':'·πõ','‡•Ñ':'·πù',
    '‡•á':'e','‡•à':'ai','‡•ã':'o','‡•å':'au',
    '‡§Ç':'·πÉ','‡§É':'·∏•','‡§Å':'ÃÉ',
    '‡•ç':'','‡§Ω':"'",'‡•§':'|','‡••':'||',
    '‡•¶':'0','‡•ß':'1','‡•®':'2','‡•©':'3','‡•™':'4','‡•´':'5','‡•¨':'6','‡•≠':'7','‡•Æ':'8','‡•Ø':'9'
  };

  const benToIAST = {
    '‡¶ï':'k','‡¶ñ':'kh','‡¶ó':'g','‡¶ò':'gh','‡¶ô':'·πÖ',
    '‡¶ö':'c','‡¶õ':'ch','‡¶ú':'j','‡¶ù':'jh','‡¶û':'√±',
    '‡¶ü':'·π≠','‡¶†':'·π≠h','‡¶°':'·∏ç','‡¶¢':'·∏çh','‡¶£':'·πá',
    '‡¶§':'t','‡¶•':'th','‡¶¶':'d','‡¶ß':'dh','‡¶®':'n',
    '‡¶™':'p','‡¶´':'ph','‡¶¨':'b','‡¶≠':'bh','‡¶Æ':'m',
    '‡¶Ø':'y','‡¶∞':'r','‡¶≤':'l','‡¶∂':'≈õ','‡¶∑':'·π£','‡¶∏':'s','‡¶π':'h',
    '‡¶Ö':'a','‡¶Ü':'ƒÅ','‡¶á':'i','‡¶à':'ƒ´','‡¶â':'u','‡¶ä':'≈´','‡¶ã':'·πõ','‡ß†':'·πù',
    '‡¶è':'e','‡¶ê':'ai','‡¶ì':'o','‡¶î':'au',
    '‡¶æ':'ƒÅ','‡¶ø':'i','‡ßÄ':'ƒ´','‡ßÅ':'u','‡ßÇ':'≈´','‡ßÉ':'·πõ','‡ßÑ':'·πù',
    '‡ßá':'e','‡ßà':'ai','‡ßã':'o','‡ßå':'au',
    '‡¶Ç':'·πÉ','‡¶É':'·∏•','‡¶Å':'ÃÉ',
    '‡ßç':'','‡•§':'|','‡••':'||',
    '‡ß¶':'0','‡ßß':'1','‡ß®':'2','‡ß©':'3','‡ß™':'4','‡ß´':'5','‡ß¨':'6','‡ß≠':'7','‡ßÆ':'8','‡ßØ':'9'
  };

  function isConsonantDevanagari(c) {
    return /[‡§ï-‡§π]/.test(c);
  }
  function isVowelSignDevanagari(c) {
    return /[‡§æ‡§ø‡•Ä‡•Å‡•Ç‡•É‡•Ñ‡•á‡•à‡•ã‡•å]/.test(c);
  }
  function devanagariToIAST(input) {
    let output = '';
    const chars = Array.from(input);
    for (let i = 0; i < chars.length; i++) {
      const c = chars[i], next = chars[i+1];
      const mapped = devToIAST[c] || c;
      if (isConsonantDevanagari(c)) {
        if (next === '‡•ç') output += mapped;
        else if (isVowelSignDevanagari(next)) output += mapped;
        else output += mapped + 'a';
      } else if (isVowelSignDevanagari(c)) output += mapped;
      else if (c === '‡•ç') continue;
      else output += mapped;
    }
    return output;
  }

  function isConsonantBengali(c) {
    return /[‡¶ï-‡¶π]/.test(c);
  }
  function isVowelSignBengali(c) {
    return /[‡¶æ‡¶ø‡ßÄ‡ßÅ‡ßÇ‡ßÉ‡ßÑ‡ßá‡ßà‡ßã‡ßå]/.test(c);
  }
  function bengaliToIAST(input) {
    let output = '';
    const chars = Array.from(input);
    for (let i = 0; i < chars.length; i++) {
      const c = chars[i], next = chars[i+1];
      const mapped = benToIAST[c] || c;
      if (isConsonantBengali(c)) {
        if (next === '‡ßç') output += mapped;
        else if (isVowelSignBengali(next)) output += mapped;
        else output += mapped + 'a';
      } else if (isVowelSignBengali(c)) output += mapped;
      else if (c === '‡ßç') continue;
      else output += mapped;
    }
    return output;
  }

  // --- Reverse IAST ---
  function iastToDevanagari(iast) {
    // naive reverse mapping for demo (extendable)
    let out = iast;
    for (const [key,val] of Object.entries(devToIAST)) {
      out = out.replace(new RegExp(val,'g'), key);
    }
    return out;
  }

  function iastToBengali(iast) {
    let out = iast;
    for (const [key,val] of Object.entries(benToIAST)) {
      out = out.replace(new RegExp(val,'g'), key);
    }
    return out;
  }

  function toIAST(text, from) {
    if (from === 'devanagari') return devanagariToIAST(text);
    if (from === 'bengali') return bengaliToIAST(text);
    return text;
  }

  function fromIAST(text, to) {
    if (to === 'devanagari') return iastToDevanagari(text);
    if (to === 'bengali') return iastToBengali(text);
    return text;
  }

  // --- Main Processing ---
  function processInput() {
    const inputText = document.getElementById("inputBox").value.trim();
    const inputScript = document.getElementById("inputScript").value;
    const outputScript = document.getElementById("outputScript").value;
    const outputDiv = document.getElementById("output");
    outputDiv.innerHTML = '';

    if (!inputText) return;

    const clusters = inputText.split(/\n\s*\n/); // separate by double line breaks

    clusters.forEach(cluster => {
      const clusterTrimmed = cluster.trim();
      if (!clusterTrimmed) return;

      let iastText;
      if (inputScript === 'iast') iastText = clusterTrimmed;
      else iastText = toIAST(clusterTrimmed, inputScript);

      let outBlock = document.createElement('div');
      outBlock.className = 'shloka';

      if (outputScript === 'iast') {
        const el = document.createElement('div');
        el.className = 'iast';
        el.textContent = iastText;
        outBlock.appendChild(el);
      }
      else if (outputScript === 'devanagari') {
        const devText = inputScript === 'iast' ? fromIAST(iastText, 'devanagari') : clusterTrimmed;
        const el = document.createElement('div');
        el.className = 'devanagari';
        el.textContent = devText;
        outBlock.appendChild(el);
      }
      else if (outputScript === 'bengali') {
        const benText = inputScript === 'iast' ? fromIAST(iastText, 'bengali') : clusterTrimmed;
        const el = document.createElement('div');
        el.className = 'bengali';
        el.textContent = benText;
        outBlock.appendChild(el);
      }
      else if (outputScript === 'both') {
        // original (as typed)
        const origEl = document.createElement('div');
        origEl.className = inputScript === 'bengali' ? 'bengali' :
                           inputScript === 'devanagari' ? 'devanagari' : 'iast';
        origEl.textContent = clusterTrimmed;
        outBlock.appendChild(origEl);

        // iast
        const iastEl = document.createElement('div');
        iastEl.className = 'iast';
        iastEl.textContent = iastText;
        outBlock.appendChild(iastEl);
      }

      outputDiv.appendChild(outBlock);
    });
  }
</script>

</body>
</html>
